---
title: 65有效数字
date: 2021-08-02 16:32:39
permalink: /pages/140ec4/
categories:
  - 算法
  - 算法-图
tags:
  - 
---
**示例 1：**

```
输入：s = "0"
输出：true
```
<!-- more -->
`有效数字`（按顺序）可以分成以下几个部分：

- 一个 小数 或者 整数
- 可选）一个 'e' 或 'E' ，后面跟着一个 整数

`小数`（按顺序）可以分成以下几个部分：

- （可选）一个符号字符（'+' 或 '-'）
- 下述格式之一：
  - 至少一位数字，后面跟着一个点 '.'
  - 至少一位数字，后面跟着一个点 '.' ，后面再跟着至少一位数字
  - 一个点 '.' ，后面跟着至少一位数字

`整数`（按顺序）可以分成以下几个部分：

- （可选）一个符号字符（'+' 或 '-'）
- 至少一位数字

部分有效数字列举如下：

- ["2", "0089", "-0.1", "+3.14", "4.", "-.9", "2e10", "-90E3", "3e+7", "+6e-1", "53.5e93", "-123.456e789"]

部分无效数字列举如下：

- ["abc", "1a", "1e", "e3", "99e2.5", "--6", "-+3", "95a54e53"]

> 给你一个字符串 s ，如果 s 是一个 有效数字 ，请返回 true 。

**示例 1：**

```
输入：s = "0"
输出：true
```

**示例 2：**

```
输入：s = "e"
输出：false
```

**示例 3：**

```
输入：s = "."
输出：false
```

::: details 提示：

- `1 <= s.length <= 20`
- `s` 仅含英文字母（大写和小写），数字（`0-9`），加号 `'+'` ，减号 `'-'` ，或者点 `'.'` 。

:::

```js
/**
 * @param {string} s
 * @return {boolean}
 */
var isNumber = function(s) {

};
```



## 解题思路

::: details

![image-20210802154126508](https://gitee.com/sheep101/typora-img-save/raw/master/img/20210802154126.png)



:::

## 解题步骤

::: details

- 构建一个表示状态的图 [邻接表]
- 遍历字符串，并沿着图走，如果到了摸个节点无路可走就返回 `false`
- 遍历结束，如果走到 3/5/6 就返回 `true`  否则返回`false`

:::

## 解题代码

::: details

- 构建有限状态机（DFA）这里用邻接矩阵表示

```js
  const graph = {
    0: { 'blank': 0, 'sign': 1, '.': 2, 'digit': 6 },//空格 +-符号 点 数字
    1: { 'digit': 6, '.': 2 },
    2: { 'digit': 3 },
    3: { 'digit': 3, 'Ele': 4 },
    4: { 'digit': 5, 'sign': 7 },
    5: { 'digit': 5 },
    6: { 'digit': 6, '.': 3, 'Ele': 4 },
    7: { 'digit': 5 },
  }
```

- 记录状态变化 并遍历字符串 `for of ` 同时为了降低复杂度 我们去除前后空格`s.trim()`

```js
let state = 0
for(c of s.trim()){
    
}
```

- 转换类型 将数字转换成`digit`，空格==>`black`  , +- ==>`sign` , e ==>`Ele`,点 ==> `.`

```js
  for (c of s.trim()) {//trim 去掉首尾的空格
    if (c >= '0' && c <= '9') {
      c = 'digit'; //数字转换成digit
    } else if (c === ' ') {
      c = 'blank'
    } else if (c === '+' || c === '-') {
      c = 'sign'
    } else if (c === 'e' || c === 'E') {
      c = 'Ele'
    }
  }
```

- 更新状态

```js
    state = graph[state][c]// 获取新的状态
    //无路可走直接false
    if (state === undefined) {
      return false;
    }
```

- 全部走完了 得比较

```js
  if (state === 3 || state === 5 || state === 6) {
    return true
  }
  return false
```

完整代码

```js {27}
/**
 * @param {string} s
 * @return {boolean}
 */
var isNumber = function (s) {
  const graph = {
    0: { 'blank': 0, 'sign': 1, '.': 2, 'digit': 6 },//空格 +-符号 点 数字
    1: { 'digit': 6, '.': 2 },
    2: { 'digit': 3 },
    3: { 'digit': 3, 'Ele': 4 },
    4: { 'digit': 5, 'sign': 7 },
    5: { 'digit': 5 },
    6: { 'digit': 6, '.': 3, 'Ele': 4 },
    7: { 'digit': 5 },
  }
  let state = 0 //记录状态
  for (c of s.trim()) {//trim 去掉首尾的空格
    if (c >= '0' && c <= '9') {
      c = 'digit'; //数字转换成digit
    } else if (c === ' ') {
      c = 'blank'
    } else if (c === '+' || c === '-') {
      c = 'sign'
    } else if (c === 'e' || c === 'E') {
      c = 'Ele'
    }
    state = graph[state][c]// 获取新的状态
    //无路可走直接false
    if (state === undefined) {
      return false;
    }
  }
  if (state === 3 || state === 5 || state === 6) {
    return true
  }
  return false
};
```

- 时间复杂度：O(n)
- 空间复杂度：O(1)

:::